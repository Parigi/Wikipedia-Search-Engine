<mediawiki xmlns="http://www.mediawiki.org/xml/export-0.10/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mediawiki.org/xml/export-0.10/ http://www.mediawiki.org/xml/export-0.10.xsd" version="0.10" xml:lang="en">
  <siteinfo>
    <sitename>Wikipedia</sitename>
    <dbname>enwiki</dbname>
    <base>https://en.wikipedia.org/wiki/Main_Page</base>
    <generator>MediaWiki 1.35.0-wmf.36</generator>
    <case>first-letter</case>
    <namespaces>
      <namespace key="-2" case="first-letter">Media</namespace>
      <namespace key="-1" case="first-letter">Special</namespace>
      <namespace key="0" case="first-letter" />
      <namespace key="1" case="first-letter">Talk</namespace>
      <namespace key="2" case="first-letter">User</namespace>
      <namespace key="3" case="first-letter">User talk</namespace>
      <namespace key="4" case="first-letter">Wikipedia</namespace>
      <namespace key="5" case="first-letter">Wikipedia talk</namespace>
      <namespace key="6" case="first-letter">File</namespace>
      <namespace key="7" case="first-letter">File talk</namespace>
      <namespace key="8" case="first-letter">MediaWiki</namespace>
      <namespace key="9" case="first-letter">MediaWiki talk</namespace>
      <namespace key="10" case="first-letter">Template</namespace>
      <namespace key="11" case="first-letter">Template talk</namespace>
      <namespace key="12" case="first-letter">Help</namespace>
      <namespace key="13" case="first-letter">Help talk</namespace>
      <namespace key="14" case="first-letter">Category</namespace>
      <namespace key="15" case="first-letter">Category talk</namespace>
      <namespace key="100" case="first-letter">Portal</namespace>
      <namespace key="101" case="first-letter">Portal talk</namespace>
      <namespace key="108" case="first-letter">Book</namespace>
      <namespace key="109" case="first-letter">Book talk</namespace>
      <namespace key="118" case="first-letter">Draft</namespace>
      <namespace key="119" case="first-letter">Draft talk</namespace>
      <namespace key="446" case="first-letter">Education Program</namespace>
      <namespace key="447" case="first-letter">Education Program talk</namespace>
      <namespace key="710" case="first-letter">TimedText</namespace>
      <namespace key="711" case="first-letter">TimedText talk</namespace>
      <namespace key="828" case="first-letter">Module</namespace>
      <namespace key="829" case="first-letter">Module talk</namespace>
      <namespace key="2300" case="first-letter">Gadget</namespace>
      <namespace key="2301" case="first-letter">Gadget talk</namespace>
      <namespace key="2302" case="case-sensitive">Gadget definition</namespace>
      <namespace key="2303" case="case-sensitive">Gadget definition talk</namespace>
    </namespaces>
  </siteinfo>
  <page>
    <title>Harmonic mean</title>
    <ns>0</ns>
    <id>14463</id>
    <revision>
      <id>961699799</id>
      <parentid>961699356</parentid>
      <timestamp>2020-06-09T22:58:07Z</timestamp>
      <contributor>
        <username>Cmglee</username>
        <id>414836</id>
      </contributor>
      <comment>/* Average speed */ Remove redundant &lt;big&gt; and ., and clarify "total time taken"</comment>
      <model>wikitext</model>
      <format>text/x-wiki</format>
      <text bytes="34215" xml:space="preserve">{{short description|Inverse of the average of the inverses of a set of numbers}}
In [[mathematics]], the '''harmonic mean''' (sometimes called the '''subcontrary mean''') is one of several kinds of [[average]], and in particular, one of the [[Pythagorean means]]. Typically, it is appropriate for situations when the average of [[rate (mathematics)|rate]]s is desired.

The harmonic mean can be expressed as the [[multiplicative inverse|reciprocal]] of the [[arithmetic mean]] of the reciprocals of the given set of observations. As a simple example, the harmonic mean of 1, 4, and 4 is
: &lt;math&gt;\left(\frac{1^{-1} + 4^{-1} + 4^{-1}}{3}\right)^{-1} = \frac{3}{\frac{1}{1} + \frac{1}{4} + \frac{1}{4}} = \frac{3}{1.5} = 2\,.&lt;/math&gt;

==Definition==
{{Unreferenced section|date=December 2019}}
The harmonic mean ''H'' of the positive [[real number]]s
&lt;math&gt;x_1, x_2, \ldots, x_n&lt;/math&gt; is defined to be

:&lt;math&gt;H = \frac{n}{\frac1{x_1} + \frac1{x_2} + \cdots + \frac1{x_n}} = \frac{n}{\sum\limits_{i=1}^n \frac1{x_i}} = \left(\frac{\sum\limits_{i=1}^n x_i^{-1}}{n}\right)^{-1}.&lt;/math&gt;

The third formula in the above equation expresses the harmonic mean as the reciprocal of the arithmetic mean of the reciprocals.

From the following formula:

:&lt;math&gt;H = \frac{n\cdot \prod\limits_{j=1}^n x_j}{ \sum\limits_{i=1}^n \left\{\frac{1}{x_i}{\prod\limits_{j=1}^n x_j}\right\}}.&lt;/math&gt;

it is more apparent that the harmonic mean is related to the [[arithmetic mean|arithmetic]] and [[geometric mean]]s. It is the reciprocal [[dual (mathematics)|dual]] of the [[arithmetic mean]] for positive inputs:

:&lt;math&gt;1/H(1/x_1 \ldots 1/x_n) = A(x_1 \ldots x_n)&lt;/math&gt;

The harmonic mean is a [[Schur-concave]] function, and dominated by the minimum of its arguments, in the sense that for any positive set of arguments, &lt;math&gt;\min(x_1 \ldots x_n) \le H(x_1 \ldots x_n) \le n \min(x_1 \ldots x_n)&lt;/math&gt;. Thus, the harmonic mean cannot be made [[arbitrarily large]] by changing some values to bigger ones (while having at least one value unchanged).

==Relationship with other means==
The harmonic mean is one of the three [[Pythagorean means]]. For all ''positive'' data sets ''containing at least one pair of nonequal values'', the harmonic mean is always the least of the three means,&lt;ref&gt;Da-Feng Xia, Sen-Lin Xu, and Feng Qi, "A proof of the arithmetic mean-geometric mean-harmonic mean inequalities", RGMIA Research Report Collection, vol. 2, no. 1, 1999, http://ajmaa.org/RGMIA/papers/v2n1/v2n1-10.pdf&lt;/ref&gt; while the [[arithmetic mean]] is always the greatest of the three and the [[geometric mean]] is always in between. (If all values in a nonempty dataset are equal, the three means are always equal to one another; e.g., the harmonic, geometric, and arithmetic means of {2,&amp;nbsp;2,&amp;nbsp;2} are all&amp;nbsp;2.)

It is the special case ''M''&lt;sub&gt;−1&lt;/sub&gt; of the [[power mean]]:

:&lt;math&gt;H\left(x_1, x_2, \ldots, x_n\right) = M_{-1}\left(x_1, x_2, \ldots, x_n\right) = \frac{n}{x_1^{-1} + x_2^{-1} + \cdots + x_n^{-1}}&lt;/math&gt;

Since the harmonic mean of a list of numbers tends strongly toward the least elements of the list, it tends (compared to the arithmetic mean) to mitigate the impact of large outliers and aggravate the impact of small ones.

The arithmetic mean is often mistakenly used in places calling for the harmonic mean.&lt;ref&gt;*''Statistical Analysis'', Ya-lun Chou, Holt International, 1969, {{ISBN|0030730953}}&lt;/ref&gt; In the speed example [[#Examples|below]] for instance, the arithmetic mean of 40 is incorrect, and too big.

The harmonic mean is related to the other Pythagorean means, as seen in the equation below. This can be seen by interpreting the denominator to be the arithmetic mean of the product of numbers ''n'' times but each time omitting the ''j''-th term. That is, for the first term, we multiply all ''n'' numbers except the first; for the second, we multiply all ''n'' numbers except the second; and so on. The numerator, excluding the ''n'', which goes with the arithmetic mean, is the geometric mean to the power&amp;nbsp;''n''. Thus the ''n''-th harmonic mean is related to the ''n''-th geometric and arithmetic means. The general formula is

:&lt;math&gt;H\left(x_1, \ldots, x_n\right) =
  \frac{\left(G\left(x_1, \ldots, x_n\right)\right)^n}
       {A\left(x_2 x_3 \cdots x_n, x_1 x_3 \cdots x_n, \ldots, x_1 x_2 \cdots x_{n-1}\right)} =
  \frac{\left(G\left(x_1, \ldots, x_n\right)\right)^n}
       {A\left(
         \frac{1}{x_1} {\prod\limits_{i=1}^n x_i},
         \frac{1}{x_2} {\prod\limits_{i=1}^n x_i},
         \ldots,
         \frac{1}{x_n} {\prod\limits_{i=1}^n x_i}
       \right)}.
&lt;/math&gt;

If a set of non-identical numbers is subjected to a [[mean-preserving spread]] — that is, two or more elements of the set are "spread apart" from each other while leaving the arithmetic mean unchanged — then the harmonic mean always decreases.&lt;ref&gt;Mitchell, Douglas W., "More on spreads and non-arithmetic means," ''[[The Mathematical Gazette]]'' 88, March 2004, 142–144.&lt;/ref&gt;

==Harmonic mean of two or three numbers==
{{Unreferenced section|date=December 2019}}
===Two numbers===
[[File:MathematicalMeans.svg|thumb|right|A geometric construction of the three [[Pythagorean means]] of two numbers, ''a'' and ''b''. The harmonic mean is denoted by ''H'' in purple. ''Q'' denotes a fourth mean, the [[quadratic mean]]. Since a [[hypotenuse]] is always longer than a leg of a [[right triangle]], the diagram shows that ''Q'' &gt; ''A'' &gt; ''G'' &gt; ''H''.]]

For the special case of just two numbers, &lt;math&gt;x_1&lt;/math&gt; and &lt;math&gt;x_2&lt;/math&gt;, the harmonic mean can be written
:&lt;math&gt;H = \frac{2x_1 x_2}{x_1 + x_2}.&lt;/math&gt;

In this special case, the harmonic mean is related to the [[arithmetic mean]] &lt;math&gt;A = \frac{x_1 + x_2}{2}&lt;/math&gt; and the [[geometric mean]] &lt;math&gt;G = \sqrt{x_1 x_2},&lt;/math&gt; by
:&lt;math&gt;H = \frac{G^2}{A} = G \cdot \left(\frac{G}{A}\right).&lt;/math&gt;

Since &lt;math&gt;\tfrac{G}{A} \le 1&lt;/math&gt; by the [[inequality of arithmetic and geometric means]], this shows for the ''n'' = 2 case that ''H'' &amp;le; ''G'' (a property that in fact holds for all ''n''). It also follows that &lt;math&gt;G = \sqrt{AH}&lt;/math&gt;, meaning the two numbers' geometric mean equals the geometric mean of their arithmetic and harmonic means.

===Three numbers===
For the special case of three numbers, &lt;math&gt;x_1&lt;/math&gt;, &lt;math&gt;x_2&lt;/math&gt; and &lt;math&gt;x_3&lt;/math&gt;, the harmonic mean can be written
:&lt;math&gt;H = \frac{3 x_1 x_2 x_3}{x_1 x_2 + x_1 x_3 + x_2 x_3}.&lt;/math&gt;

Three positive numbers ''H'', ''G'', and ''A'' are respectively the harmonic, geometric, and arithmetic means of three positive numbers [[if and only if]]&lt;ref name=Crux&gt;''Inequalities proposed in “[[Crux Mathematicorum]]”'', {{cite web |url=http://www.imomath.com/othercomp/Journ/ineq.pdf |title=Archived copy |accessdate=2014-09-09 |url-status=live |archiveurl=https://web.archive.org/web/20141015174828/http://www.imomath.com/othercomp/Journ/ineq.pdf |archivedate=2014-10-15 }}.&lt;/ref&gt;{{rp|p.74,#1834}} the following inequality holds

:&lt;math&gt;\frac{A^3}{G^3} + \frac{G^3}{H^3} + 1 \le \frac3{4} \left(1 + \frac{A}{H}\right)^2.&lt;/math&gt;

==Weighted harmonic mean==
{{Unreferenced section|date=December 2019}}
If a set of [[weight function|weights]] &lt;math&gt;w_1&lt;/math&gt;, ..., &lt;math&gt;w_n&lt;/math&gt; is associated to the dataset &lt;math&gt;x_1&lt;/math&gt;, ..., &lt;math&gt;x_n&lt;/math&gt;, the '''weighted harmonic mean''' is defined by
:&lt;math&gt;
  H = \frac{\sum\limits_{i=1}^n w_i}{\sum\limits_{i=1}^n \frac{w_i}{x_i}}
    = \left( \frac{\sum\limits_{i=1}^n w_i x_i^{-1}}{\sum\limits_{i=1}^n w_i} \right)^{-1}.
&lt;/math&gt;

The unweighted harmonic mean can be regarded as the special case where all of the weights are equal.

==Examples==

===In physics===
====Average speed====
In many situations involving [[rate (mathematics)|rate]]s and [[ratio]]s, the harmonic mean provides the truest [[average]]. For instance, if a vehicle travels a certain distance ''d'' outbound at a speed ''x'' (e.g. 60&amp;nbsp;km/h) and returns the same distance at a speed ''y'' (e.g. 20&amp;nbsp;km/h), then its average speed is the harmonic mean of ''x'' and ''y'' (30&amp;nbsp;km/h) &amp;ndash; not the arithmetic mean (40&amp;nbsp;km/h). The total travel time is the same as if it had traveled the whole distance at that average speed. This can be proven as follows:&lt;ref&gt;{{cite web|url=https://learningpundits.com/module-view/48-averages/1-tips-on-averages/|title=Average: How to calculate Average, Formula, Weighted average|website=learningpundits.com|accessdate=8 May 2018|url-status=live|archiveurl=https://web.archive.org/web/20171229231610/https://learningpundits.com/module-view/48-averages/1-tips-on-averages/|archivedate=29 December 2017}}&lt;/ref&gt;

Average speed for the entire journey
= &lt;big&gt;{{sfrac|Total distance traveled|Sum of time for each segment}}&lt;/big&gt;
= {{sfrac|2''d''|&lt;big&gt;{{sfrac|''d''|''x''}} + {{sfrac|''d''|''y''}}&lt;/big&gt;}} = {{sfrac|2|&lt;big&gt;{{sfrac|1|''x''}}+{{sfrac|1|''y''}}&lt;/big&gt;}}

However, if the vehicle travels for a certain amount of ''time'' at a speed ''x'' and then the same amount of time at a speed ''y'', then its average speed is the [[arithmetic mean]] of ''x'' and ''y'', which in the above example is 40&amp;nbsp;km/h. The same principle applies to more than two segments: given a series of sub-trips at different speeds, if each sub-trip covers the same ''distance'', then the average speed is the ''harmonic'' mean of all the sub-trip speeds; and if each sub-trip takes the same amount of ''time'', then the average speed is the ''arithmetic'' mean of all the sub-trip speeds. (If neither is the case, then a [[#Weighted harmonic mean|weighted harmonic mean]] or [[weighted arithmetic mean]] is needed. For the arithmetic mean, the speed of each portion of the trip is weighted by the duration of that portion, while for the harmonic mean, the corresponding weight is the distance.  In both cases, the resulting formula reduces to dividing the total distance by the total time.)

However one may avoid the use of the harmonic mean for the case of "weighting by distance". Pose the problem as finding "slowness" of the trip where "slowness" (in hours per kilometre) is the inverse of speed. When trip slowness is found, invert it so as to find the "true" average trip speed. For each trip segment i, the slowness s&lt;sub&gt;i&lt;/sub&gt; = 1/speed&lt;sub&gt;i&lt;/sub&gt;. Then take the weighted [[arithmetic mean]] of the s&lt;sub&gt;i&lt;/sub&gt;'s weighted by their respective distances (optionally with the weights normalized so they sum to 1 by dividing them by trip length). This gives the true average slowness (in time per kilometre). It turns out that this procedure, which can be done with no knowledge of the harmonic mean, amounts to the same mathematical operations as one would use in solving this problem by using the harmonic mean. Thus it illustrates why the harmonic mean works in this case.

====Density====
{{Unreferenced section|date=December 2019}}
Similarly, if one wishes to estimate the density of an [[alloy]] given the densities of its constituent elements and their mass fractions (or, equivalently, percentages by mass), then the predicted density of the alloy (exclusive of typically minor volume changes due to atom packing effects) is the weighted harmonic mean of the individual densities, weighted by mass, rather than the weighted arithmetic mean as one might at first expect. To use the weighted arithmetic mean, the densities would have to be weighted by volume. Applying [[dimensional analysis]] to the problem while labelling the mass units by element and making sure that only like element-masses cancel, makes this clear.

====Electricity====
If one connects two electrical [[resistor]]s in parallel, one having resistance ''x'' (e.g., 60 [[Ohm|Ω]]) and one having resistance ''y'' (e.g., 40 Ω), then the effect is the same as if one had used two resistors with the same resistance, both equal to the harmonic mean of ''x'' and ''y'' (48 Ω): the equivalent resistance, in either case, is 24 Ω (one-half of the harmonic mean). This same principle applies to [[capacitor]]s in series or to [[inductor]]s in parallel.

However, if one connects the resistors in series, then the average resistance is the arithmetic mean of ''x'' and ''y'' (with total resistance equal to the sum of x and y). As with the previous example, the same principle applies when more than two resistors are connected, provided that all are in parallel or all are in series.

The "conductivity effective mass" of a semiconductor is also defined as the harmonic mean of the effective masses along the three crystallographic directions.&lt;ref&gt;{{cite web|url=http://ecee.colorado.edu/~bart/book/effmass.htm|title=Effective mass in semiconductors|website=ecee.colorado.edu|accessdate=8 May 2018|url-status=live|archiveurl=https://web.archive.org/web/20171020040802/http://ecee.colorado.edu/~bart/book/effmass.htm|archivedate=20 October 2017}}&lt;/ref&gt;

===In finance===
The weighted harmonic mean is the preferable method for averaging multiples, such as the [[price–earnings ratio]] (P/E), in which price is in the numerator. If these ratios are averaged using a weighted arithmetic mean (a common error), high data points are given greater weights than low data points. The weighted harmonic mean, on the other hand, gives equal weight to each data point.&lt;ref&gt;{{cite book |chapter=Fairness Opinions: Common Errors and Omissions |title=The Handbook of Business Valuation and Intellectual Property Analysis |publisher=McGraw Hill |year=2004 |isbn=0-07-142967-0 }}&lt;/ref&gt; The simple weighted arithmetic mean when applied to non-price normalized ratios such as the P/E is biased upwards and cannot be numerically justified, since it is based on equalized earnings; just as vehicles speeds cannot be averaged for a roundtrip journey.&lt;ref&gt;{{cite journal |title=Using the Price-to-Earnings Harmonic Mean to Improve Firm Valuation Estimates |first=Pankaj |last=Agrrawal |first2=Richard |last2=Borgman |first3=John M. |last3=Clark |first4=Robert |last4=Strong |journal=[[Journal of Financial Education]] |volume=36 |year=2010 |issue=3–4 |pages=98–110 |jstor=41948650 |ssrn=2621087 }}&lt;/ref&gt;

For example, consider two firms, one with a [[market capitalization]] of $150 billion and earnings of $5 billion (P/E of 30) and one with a market capitalization of $1 billion and earnings of $1 million (P/E of 1000). Consider an [[Index (finance)|index]] made of the two stocks, with 30% invested in the first and 70% invested in the second. We want to calculate the P/E ratio of this index.

Using the weighted arithmetic mean (incorrect):
: &lt;math&gt;P/E = 0.3 \times 30 + 0.7 \times 1000 = 709&lt;/math&gt;

Using the weighted harmonic mean (correct):
: &lt;math&gt;P/E = \frac{0.3 + 0.7}{0.3/30 + 0.7/1000} \approx 93.46&lt;/math&gt;

Thus, the correct P/E of 93.46 of this index can only be found using the weighted harmonic mean, while the weighted arithmetic mean will significantly overestimate it.

===In geometry===
In any [[triangle]], the radius of the [[incircle and excircles of a triangle|incircle]] is one-third of the harmonic mean of the [[Altitude (triangle)|altitudes]].

For any point P on the [[Arc (geometry)|minor arc]] BC of the [[circumcircle]] of an [[equilateral triangle]] ABC, with distances ''q'' and ''t'' from B and C respectively, and with the intersection of PA and BC being at a distance ''y'' from point P, we have that ''y'' is half the harmonic mean of ''q'' and ''t''.&lt;ref&gt;{{cite book |last=Posamentier |first=Alfred S. |last2=Salkind |first2=Charles T. |title=Challenging Problems in Geometry |edition=Second |publisher=Dover |location= |year=1996 |page=[https://archive.org/details/challengingprobl0000posa/page/172 172] |isbn=0-486-69154-3 |url=https://archive.org/details/challengingprobl0000posa |url-access=registration }}&lt;/ref&gt;

In a [[right triangle]] with legs ''a'' and ''b'' and [[Altitude (triangle)|altitude]] ''h'' from the [[hypotenuse]] to the right angle, {{math|''h''²}} is half the harmonic mean of {{math|''a''²}} and {{math|''b''²}}.&lt;ref&gt;Voles, Roger, "Integer solutions of &lt;math&gt;a^{-2}+b^{-2}=d^{-2}&lt;/math&gt;," ''Mathematical Gazette'' 83, July 1999, 269–271.&lt;/ref&gt;&lt;ref&gt;Richinick, Jennifer, "The upside-down Pythagorean Theorem," ''Mathematical Gazette'' 92, July 2008, 313–;317.&lt;/ref&gt;

Let ''t'' and ''s'' (''t'' &gt; ''s'') be the sides of the two [[Triangle#Squares|inscribed squares in a right triangle]] with hypotenuse ''c''. Then {{math|''s''²}} equals half the harmonic mean of {{math|''c''²}} and {{math|''t''²}}.

Let a [[trapezoid]] have vertices A, B, C, and D in sequence and have parallel sides AB and CD. Let E be the intersection of the [[diagonal]]s, and let F be on side DA and G be on side BC such that FEG is parallel to AB and CD. Then FG is the harmonic mean of AB and DC. (This is provable using similar triangles.)

[[File:CrossedLadders.png|thumb|right|Crossed ladders. ''h'' is half the harmonic mean of ''A'' and ''B'']]
One application of this trapezoid result is in the [[crossed ladders problem]], where two ladders lie oppositely across an alley, each with feet at the base of one sidewall, with one leaning against a wall at height ''A'' and the other leaning against the opposite wall at height ''B'', as shown. The ladders cross at a height of ''h'' above the alley floor. Then ''h'' is half the harmonic mean of ''A'' and ''B''. This result still holds if the walls are slanted but still parallel and the "heights" ''A'', ''B'', and ''h'' are measured as distances from the floor along lines parallel to the walls. This can be proved easily using the area formula of a trapezoid and area addition formula.

In an [[ellipse]], the [[Kepler's laws of planetary motion#Mathematics of the three laws|semi-latus rectum]] (the distance from a focus to the ellipse along a line parallel to the minor axis) is the harmonic mean of the maximum and minimum distances of the ellipse from a focus.

=== In other sciences ===
In [[computer science]], specifically [[information retrieval]] and [[machine learning]], the harmonic mean of the [[Precision and recall|precision]] (true positives per predicted positive) and the [[Precision and recall|recall]] (true positives per real positive) is often used as an aggregated performance score for the evaluation of algorithms and systems: the [[F1 score|F-score]] (or F-measure). This is used in information retrieval because only the positive class is of [[relevance]], while number of negatives, in general, is large and unknown.&lt;ref&gt;{{cite book | last = Van Rijsbergen | first = C. J. | url = http://www.dcs.gla.ac.uk/Keith/Preface.html | year = 1979 | title = Information Retrieval | edition = 2nd | publisher = Butterworth | url-status = live | archiveurl = https://web.archive.org/web/20050406090119/http://www.dcs.gla.ac.uk/Keith/Preface.html | archivedate = 2005-04-06 }}&lt;/ref&gt; It is thus a trade-off as to whether the correct positive predictions should be measured in relation to the number of predicted positives or the number of real positives, so it is measured versus a putative number of positives that is an arithmetic mean of the two possible denominators.

A consequence arises from basic algebra in problems where people or systems work together. As an example, if a gas-powered pump can drain a pool in 4 hours and a battery-powered pump can drain the same pool in 6 hours, then it will take both pumps {{math|{{sfrac|6·4|6 + 4}}}}, which is equal to 2.4 hours, to drain the pool together. This is one-half of the harmonic mean of 6 and 4: {{math|{{sfrac|2·6·4|6 + 4}} {{=}} 4.8}}. That is the appropriate average for the two types of pump is the harmonic mean, and with one pair of pumps (two pumps), it takes half this harmonic mean time, while with two pairs of pumps (four pumps) it would take a quarter of this harmonic mean time.

In [[hydrology]], the harmonic mean is similarly used to average [[hydraulic conductivity]] values for a flow that is perpendicular to layers (e.g., geologic or soil) - flow parallel to layers uses the arithmetic mean. This apparent difference in averaging is explained by the fact that hydrology uses conductivity, which is the inverse of resistivity.

In [[sabermetrics]], a player's [[Power–speed number]] is the harmonic mean of their [[home run]] and [[stolen base]] totals.

In [[population genetics]], the harmonic mean is used when calculating the effects of fluctuations in the census population size on the effective population size. The harmonic mean takes into account the fact that events such as population [[wikt: bottlenecks|bottleneck]] increase the rate genetic drift and reduce the amount of genetic variation in the population.  This is a result of the fact that following a bottleneck very few individuals contribute to the [[gene pool]] limiting the genetic variation present in the population for many generations to come.

When considering [[fuel economy in automobiles]] two measures are commonly used – miles per gallon (mpg), and litres per 100&amp;nbsp;km. As the dimensions of these quantities are the inverse of each other (one is distance per volume, the other volume per distance) when taking the mean value of the fuel economy of a range of cars one measure will produce the harmonic mean of the other – i.e., converting the mean value of fuel economy expressed in litres per 100&amp;nbsp;km to miles per gallon will produce the harmonic mean of the fuel economy expressed in miles-per-gallon.

In [[chemistry]] and [[nuclear physics]] the average mass per particle of a mixture consisting of different species (e.g., molecules or isotopes) is given by the harmonic mean of the individual species' masses weighted by their respective mass fraction.

==Beta distribution==
{{Unreferenced section|date=December 2019}}
[[File:Harmonic mean for Beta distribution for alpha and beta ranging from 0 to 5 - J. Rodal.jpg|thumb|Harmonic mean for Beta distribution for 0 &lt; α &lt; 5 and 0 &lt; β &lt; 5]]
[[File:(Mean - HarmonicMean) for Beta distribution versus alpha and beta from 0 to 2 - J. Rodal.jpg|thumb|(Mean - HarmonicMean) for Beta distribution versus alpha and beta from 0 to 2]]
[[File: Harmonic Means for Beta distribution Purple=H(X), Yellow=H(1-X), smaller values alpha and beta in front - J. Rodal.jpg|thumb|Harmonic Means for Beta distribution Purple=H(X), Yellow=H(1-X), smaller values alpha and beta in front]]
[[File: Harmonic Means for Beta distribution Purple=H(X), Yellow=H(1-X), larger values alpha and beta in front - J. Rodal.jpg|thumb|Harmonic Means for Beta distribution Purple=H(X), Yellow=H(1-X), larger values alpha and beta in front]]

The harmonic mean of a [[beta distribution]] with shape parameters ''α'' and ''β'' is:

:&lt;math&gt;H = \frac{\alpha - 1}{\alpha + \beta - 1} \text{ conditional on } \alpha &gt; 1 \, \, \&amp; \, \, \beta &gt; 0 &lt;/math&gt;

The harmonic mean with ''α'' &lt; 1 is undefined because its defining expression is not bounded in [0, 1].

Letting ''α'' = ''β''

: &lt;math&gt;H = \frac{\alpha - 1}{2 \alpha - 1}&lt;/math&gt;

showing that for ''α'' = ''β'' the harmonic mean ranges from 0 for ''α'' = ''β'' = 1, to 1/2 for ''α'' = ''β'' → ∞.

The following are the limits with one parameter finite (non-zero) and the other parameter approaching these limits:

:&lt;math&gt;\begin{align}
  \lim_{\alpha \to 0} H &amp;= \text{ undefined } \\
  \lim_{\alpha \to 1} H &amp;= \lim_{\beta \to \infty}  H = 0 \\
  \lim_{\beta \to 0}  H &amp;= \lim_{\alpha \to \infty} H = 1
\end{align}&lt;/math&gt;

With the geometric mean the harmonic mean may be useful in maximum likelihood estimation in the four parameter case.

A second harmonic mean (''H''&lt;sub&gt;1 − X&lt;/sub&gt;) also exists for this distribution

:&lt;math&gt;H_{1-X} =  \frac{\beta - 1}{\alpha + \beta - 1} \text{ conditional on } \beta &gt; 1 \, \, \&amp; \, \, \alpha &gt; 0&lt;/math&gt;

This harmonic mean with ''β'' &lt; 1 is undefined because its defining expression is not bounded in [ 0, 1 ].

Letting ''α'' = ''β'' in the above expression

:&lt;math&gt;H_{1-X} = \frac{\beta - 1}{2 \beta - 1} &lt;/math&gt;

showing that for ''α'' = ''β'' the harmonic mean ranges from 0, for ''α'' = ''β'' = 1, to 1/2, for ''α'' = ''β'' → ∞.

The following are the limits with one parameter finite (non zero) and the other approaching these limits:

: &lt;math&gt;\begin{align}
  \lim_{\beta \to 0}  H_{1-X} &amp;= \text{ undefined } \\
  \lim_{\beta \to 1}  H_{1-X} &amp;= \lim_{\alpha \to \infty} H_{1-X} = 0 \\
  \lim_{\alpha \to 0} H_{1-X} &amp;= \lim_{\beta \to \infty}  H_{1-X} = 1
\end{align}&lt;/math&gt;

Although both harmonic means are asymmetric, when ''α'' = ''β'' the two means are equal.

==Lognormal distribution==

The harmonic mean ( ''H'' ) of a [[lognormal distribution]] is&lt;ref name=Aitchison1969&gt;Aitchison J, Brown JAC (1969). The lognormal distribution with special reference to its uses in economics. Cambridge University Press, New York&lt;/ref&gt;

: &lt;math&gt;H = \exp \left( \mu - \frac{1}{2} \sigma^2 \right),&lt;/math&gt;

where ''μ'' is the arithmetic mean and ''σ''&lt;sup&gt;2&lt;/sup&gt; is the variance of the distribution.

The harmonic and arithmetic means are related by

: &lt;math&gt;\frac{\mu}{H} = 1 + C_v \, ,&lt;/math&gt;

where ''C''&lt;sub&gt;v&lt;/sub&gt; is the [[coefficient of variation]].

The geometric (''G''), arithmetic and harmonic means are related by&lt;ref name=Rossman1990&gt;Rossman LA (1990) Design stream flows based on harmonic means. J Hydr Eng ASCE 116(7) 946–950&lt;/ref&gt;

: &lt;math&gt;H \mu = G^2.&lt;/math&gt;

==Pareto distribution==

The harmonic mean of type 1 [[Pareto distribution]] is&lt;ref name=Johnson1994&gt;Johnson NL, Kotz S, Balakrishnan N (1994) Continuous univariate distributions Vol 1. Wiley Series in Probability and Statistics.&lt;/ref&gt;

: &lt;math&gt;H = k \left( 1 + \frac{1}{\alpha} \right)&lt;/math&gt;

where ''k'' is the scale parameter and ''α'' is the shape parameter.

==Statistics==

For a random sample, the harmonic mean is calculated as above. Both the [[Expected value|mean]] and the [[variance]] may be [[Infinity|infinite]] (if it includes at least one term of the form 1/0).

===Sample distributions of mean and variance===

The mean of the sample ''m'' is  asymptotically distributed normally with variance ''s''&lt;sup&gt;2&lt;/sup&gt;.
:&lt;math&gt;s^2 = \frac{m \left[\operatorname{E}\left(\frac{1}{x} - 1\right)\right]}{m^2 n}&lt;/math&gt;

The variance of the mean itself is&lt;ref name=Zelen1972&gt;Zelen M (1972) Length-biased sampling and biomedical problems. In: Biometric Society Meeting, Dallas, Texas&lt;/ref&gt;
: &lt;math&gt;\operatorname{Var}\left(\frac{1}{x}\right) = \frac{m \left[\operatorname{E}\left(\frac{1}{x} - 1\right)\right]}{n m^2}&lt;/math&gt;

where ''m'' is the arithmetic mean of the reciprocals, ''x'' are the variates, ''n'' is the population size and ''E'' is the expectation operator.

===Delta method===
{{Unreferenced section|date=December 2019}}

Assuming that the variance is not infinite and that the [[central limit theorem]] applies to the sample then using the [[delta method]], the variance is

: &lt;math&gt;\operatorname{Var}(H) = \frac{1}{n}\frac{s^2}{m^4}&lt;/math&gt;

where ''H'' is the harmonic mean, ''m'' is the arithmetic mean of the reciprocals

: &lt;math&gt;m = \frac{1}{n} \sum{ \frac{1}{x} }.&lt;/math&gt;

''s''&lt;sup&gt;2&lt;/sup&gt; is the variance of the reciprocals of the data

: &lt;math&gt;s^2 = \operatorname{Var}\left( \frac{1}{x} \right) &lt;/math&gt;

and ''n'' is the number of data points in the sample.

===Jackknife method===

A [[resampling (statistics)#Jackknife|jackknife]] method of estimating the variance is possible if the mean is known.&lt;ref name=Lam1985&gt;Lam FC (1985) Estimate of variance for harmonic mean half lives. J Pharm Sci 74(2) 229-231&lt;/ref&gt; This method is the usual 'delete 1' rather than the 'delete m' version.

This method first requires the computation of the mean of the sample (''m'')
: &lt;math&gt;m = \frac{n}{ \sum{ \frac{1}{x} } }&lt;/math&gt;

where ''x'' are the sample values.

A series of value ''w&lt;sub&gt;i&lt;/sub&gt;'' is then computed where
: &lt;math&gt;w_i = \frac{n - 1}{ \sum_{j \neq i} \frac{1}{x} }.&lt;/math&gt; &lt;--{what is j?}

The mean (''h'') of the ''w''&lt;sub&gt;i&lt;/sub&gt; is then taken:
: &lt;math&gt;h = \frac{1}{n} \sum{w_i}&lt;/math&gt;

The variance of the mean is
: &lt;math&gt;\frac{n - 1}{n} \sum{(m - h)}^2.&lt;/math&gt;

Significance testing and [[confidence interval]]s for the mean can then be estimated with the [[t test]].

===Size biased sampling===

Assume a random variate has a distribution ''f''( ''x'' ). Assume also that the likelihood of a variate being chosen is proportional to its value. This is known as length based or size biased sampling.

Let ''μ'' be the mean of the population. Then the [[probability density function]] ''f''*( ''x'' ) of the size biased population is
: &lt;math&gt;f^*(x) = \frac{x f(x)}{\mu}&lt;/math&gt;

The expectation of this length biased distribution E&lt;sup&gt;*&lt;/sup&gt;( ''x'' ) is&lt;ref name="Zelen1972"/&gt;
: &lt;math&gt;\operatorname{E}^*(x) = \mu \left[ 1 + \frac{\sigma^2}{\mu^2} \right]&lt;/math&gt;

where ''σ''&lt;sup&gt;2&lt;/sup&gt; is the variance.

The expectation of the harmonic mean is the same as the non-length biased version E( ''x'' )
:  &lt;math&gt; E^*( x^{ -1 } ) = E( x )^{ -1 } &lt;/math&gt;

The problem of length biased sampling arises in a number of areas including textile manufacture&lt;ref name=Cox1969&gt;Cox DR (1969) Some sampling problems in technology. In: New developments in survey sampling. U.L. Johnson, H Smith eds. New York: Wiley Interscience&lt;/ref&gt; pedigree analysis&lt;ref name=Davidov2001&gt;Davidov O, Zelen M (2001) Referent sampling, family history and relative risk: the role of length‐biased sampling. Biostat 2(2): 173-181 {{doi|10.1093/biostatistics/2.2.173}}&lt;/ref&gt; and survival analysis&lt;ref name=Zelen1969&gt;Zelen M, Feinleib M (1969) On the theory of screening for chronic diseases. Biometrika 56: 601-614&lt;/ref&gt;

Akman ''et al'' have developed a test for the detection of length based bias in samples.&lt;ref name=Akman2007&gt;Akman O, Gamage J, Jannot J, Juliano S, Thurman A, Whitman D (2007) A simple test for detection of length-biased sampling. J Biostats 1 (2) 189-195&lt;/ref&gt;

===Shifted variables===

If ''X'' is a positive random variable and ''q'' &gt; 0 then for all ''ε'' &gt; 0&lt;ref name=Chuen-Teck2008&gt;Chuen-Teck See, Chen J (2008) Convex functions of random variables. J Inequal Pure Appl Math 9 (3) Art 80&lt;/ref&gt;
: &lt;math&gt;\operatorname{Var} \left[\frac{1}{(X + \epsilon)^q}\right] &lt; \operatorname{Var} \left(\frac{1}{X^q}\right) .&lt;/math&gt;

===Moments===

Assuming that ''X'' and E(''X'') are &gt; 0 then&lt;ref name="Chuen-Teck2008"/&gt;
: &lt;math&gt;\operatorname{E}\left[ \frac{1}{X} \right] \ge \frac{1}{ \operatorname{E}(X) }&lt;/math&gt;

This follows from [[Jensen's inequality]].

Gurland has shown that&lt;ref name=Gurland1967&gt;Gurland J (1967) An inequality satisfied by the expectation of the reciprocal of a random variable. The American Statistician. 21 (2) 24&lt;/ref&gt; for a distribution that takes only positive values, for any ''n'' &gt; 0
: &lt;math&gt;\operatorname{E} \left(X^{-1}\right) \ge \frac{\operatorname{E} \left(X^{n-1}\right)}{\operatorname{E}\left(X^n\right)} .&lt;/math&gt;

Under some conditions&lt;ref name=Sung2010&gt;Sung SH (2010) On inverse moments for a class of nonnegative random variables. J Inequal Applic {{doi|10.1155/2010/823767}}&lt;/ref&gt;
: &lt;math&gt;\operatorname{E}(a + X)^{-n} \sim \operatorname{E}\left(a + X^{-n}\right)&lt;/math&gt;

where ~ means approximately.

===Sampling properties===

Assuming that the variates (''x'') are drawn from a lognormal distribution there are several possible estimators for ''H'':

: &lt;math&gt;\begin{align}
  H_1 &amp;= \frac{n}{ \sum\left(\frac{1}{x}\right) } \\
  H_2 &amp;= \frac{\left( \exp\left[ \frac{1}{n} \sum \log_e(x) \right] \right)^2}{ \frac{1}{n} \sum(x) } \\
  H_3 &amp;= \exp \left(m - \frac{1}{2} s^2 \right)
\end{align}&lt;/math&gt;

where
: &lt;math&gt;m = \frac{1}{n} \sum \log_e (x)&lt;/math&gt;
: &lt;math&gt;s^2 = \frac{1}{n} \sum \left(\log_e (x) - m\right)^2&lt;/math&gt;

Of these ''H''&lt;sub&gt;3&lt;/sub&gt; is probably the best estimator for samples of 25 or more.&lt;ref name=Stedinger1980&gt;Stedinger JR (1980) Fitting lognormal distributions to hydrologic data. Water Resour Res 16(3) 481–490&lt;/ref&gt;

===Bias and variance estimators===

A first order approximation to the [[bias]] and variance of ''H''&lt;sub&gt;1&lt;/sub&gt; are&lt;ref name=Limbrunner2000&gt;Limbrunner JF, Vogel RM, Brown LC (2000) Estimation of harmonic mean of a lognormal variable. J Hydrol Eng 5(1) 59-66 {{cite web |url=http://engineering.tufts.edu/cee/people/vogel/publications/estimation-harmonic.pdf |title=Archived copy |accessdate=2012-09-16 |url-status=dead |archiveurl=https://web.archive.org/web/20100611205528/http://engineering.tufts.edu/cee/people/vogel/publications/estimation-harmonic.pdf |archivedate=2010-06-11 }}&lt;/ref&gt;

: &lt;math&gt;\begin{align}
  \operatorname{bias}\left[ H_1 \right] &amp;= \frac{H C_v}{n} \\
   \operatorname{Var}\left[ H_1 \right] &amp;= \frac{H^2 C_v}{n}
\end{align}&lt;/math&gt;

where ''C''&lt;sub&gt;v&lt;/sub&gt; is the coefficient of variation.

Similarly a first order approximation to the bias and variance of ''H''&lt;sub&gt;3&lt;/sub&gt; are&lt;ref name="Limbrunner2000"/&gt;

: &lt;math&gt;\begin{align}
  \frac{H \log_e \left(1 + C_v\right)}{2n} \left[ 1 + \frac{1 + C_v^2}{2} \right] \\
  \frac{H \log_e \left(1 + C_v\right)}{n} \left[ 1 + \frac{1 + C_v^2}{4} \right]
\end{align}&lt;/math&gt;

In numerical experiments ''H''&lt;sub&gt;3&lt;/sub&gt; is generally a superior estimator of the harmonic mean than ''H''&lt;sub&gt;1&lt;/sub&gt;.&lt;ref name="Limbrunner2000"/&gt; ''H''&lt;sub&gt;2&lt;/sub&gt; produces estimates that are largely similar to ''H''&lt;sub&gt;1&lt;/sub&gt;.

==Notes==

The [[Environmental Protection Agency]] recommends the use of the harmonic mean in setting maximum toxin levels in water.&lt;ref name=EPA1991&gt;EPA (1991) Technical support document for water quality-based toxics control. EPA/505/2-90-001. Office of Water&lt;/ref&gt;

In geophysical [[reservoir engineering]] studies, the harmonic mean is widely used.&lt;ref name=Muskat1937&gt;Muskat M (1937) The flow of homogeneous fluids through porous media. McGraw-Hill, New York&lt;/ref&gt;

==See also==
{{Portal|Mathematics}}
* [[Contraharmonic mean]]
* [[Generalized mean]]
* [[Harmonic number]]
* [[Rate (mathematics)]]
* [[Weighted mean]]
* [[Parallel summation]]
* [[Geometric mean]]
* [[Weighted geometric mean]]
* [[HM-GM-AM-QM inequalities]]

==References==
{{Reflist}}

==External links==
* {{Mathworld |id=HarmonicMean |title=Harmonic Mean}}
* [http://www.cut-the-knot.org/arithmetic/HarmonicMean.shtml Averages, Arithmetic and Harmonic Means] at [[cut-the-knot]]

{{Statistics|descriptive}}

{{DEFAULTSORT:Harmonic Mean}}
[[Category:Means]]</text>
      <sha1>rntxshyevv1ezqjs2gxkplpgr3zpbta</sha1>
    </revision>
  </page>
</mediawiki>
